# QT/ë¬µìƒ ê°€ì´ë“œ

> QT ì¡°íšŒ/ì‘ì„±, ë¬µìƒ ê´€ë ¨ ì‘ì—… ì‹œ ì°¸ì¡°í•˜ì„¸ìš”.
> (ê¸°ì¡´ docs/QT_ARCHITECTURE.md í†µí•©)

---

## 1. ê°œìš”

### í•µì‹¬ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        QT ì‹œìŠ¤í…œ                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ë³´ê¸°: í”¼ë“œ ì¹´ë“œ | ìƒì„¸ ëª¨ë‹¬ | ëª©ë¡ í˜ì´ì§€                    â”‚
â”‚  ì‘ì„±: ì»¤ë®¤ë‹ˆí‹° | ê°œì¸ í”„ë¡œì íŠ¸ | êµíšŒ QT                     â”‚
â”‚  ì €ì¥: ë ˆê±°ì‹œ í…Œì´ë¸” â†’ íŠ¸ë¦¬ê±° â†’ unified_meditations          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### QT vs ë¬µìƒ êµ¬ë¶„

| êµ¬ë¶„ | QT | ì¼ë°˜ ë¬µìƒ |
|------|-----|----------|
| í˜•ì‹ | êµ¬ì¡°í™” (í•œ ë¬¸ì¥, ì§ˆë¬¸/ë‹µë³€, ê°ì‚¬, ê¸°ë„ ë“±) | ììœ  í˜•ì‹ |
| UI | ìºëŸ¬ì…€ ìŠ¤íƒ€ì¼ (QTFeedCard) | ë§ˆí¬ë‹¤ìš´ ë·°ì–´ |
| ì‹ë³„ | `source_type: 'qt'` ë˜ëŠ” `content_type: 'qt'` | `content_type: 'free'` |

### ê´€ë ¨ í˜ì´ì§€

| í˜ì´ì§€ | ê²½ë¡œ | ì„¤ëª… |
|--------|------|------|
| QT ëª©ë¡ | `/qt` | ì›”ë³„ QT ë¦¬ìŠ¤íŠ¸ |
| QT ìƒì„¸ | `/qt/[date]` | íŠ¹ì • ë‚ ì§œ QT |
| êµíšŒ QT | `/church/[code]/qt` | êµíšŒ QT ëª©ë¡ |
| êµíšŒ QT ìƒì„¸ | `/church/[code]/qt/[date]` | êµíšŒ QT ìƒì„¸ |

---

## 2. QT ë³´ê¸° ë°©ì‹

### 2.1 í”¼ë“œ ì¹´ë“œ (ì¸ìŠ¤íƒ€ê·¸ë¨ ìŠ¤íƒ€ì¼)

**ì»´í¬ë„ŒíŠ¸**: `src/components/feed/QTFeedCard.tsx`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ í”„ë¡œí•„ í—¤ë” (ê³ ì •)                   â”‚
â”‚  ì•„ë°”íƒ€ + ì´ë¦„ + QTë±ƒì§€ + ì‹œê°„       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ QT í—¤ë” (ê³ ì •)                       â”‚
â”‚  ë‚ ì§œ / ì œëª© / í†µë…ë²”ìœ„ / ONE WORD   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â† ê°€ë¡œ ìºëŸ¬ì…€ (ì¢Œìš° ìŠ¤í¬ë¡¤) â†’        â”‚
â”‚  ğŸ“– ì˜¤ëŠ˜ì˜ ë§ì”€                      â”‚
â”‚  ğŸ’­ ë¬µìƒ ê¸¸ì¡ì´                      â”‚
â”‚  â“ ë¬µìƒ ì§ˆë¬¸ + ë‹µë³€                 â”‚
â”‚  âœ¨ ë‚´ ë§ë¡œ í•œ ë¬¸ì¥                  â”‚
â”‚  âœ¦ í•˜ë£¨ ì ê²€                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ í•˜ë‹¨ ê³ ì • ì„¹ì…˜                       â”‚
â”‚  ğŸ’š ê°ì‚¬ì™€ ì ìš© / ğŸ™ ë‚˜ì˜ ê¸°ë„       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì•¡ì…˜ë°”: ì¢‹ì•„ìš” | ëŒ“ê¸€ | ë¶ë§ˆí¬       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ìƒì„¸ ëª¨ë‹¬

**ì»´í¬ë„ŒíŠ¸**: `src/components/feed/FeedDetailModal.tsx`

| íƒ€ì… | ë Œë”ë§ |
|------|--------|
| QT (`content_type: 'qt'`) | QTFeedCard ë™ì¼ ìºëŸ¬ì…€ |
| ë¬µìƒ | RichViewerWithEmbed |

---

## 3. QT ì‘ì„± ë°©ì‹

### 3.1 ì‘ì„± ìœ„ì¹˜

| ìœ„ì¹˜ | ê²½ë¡œ | ì—ë””í„° | ëŒ€ìƒ |
|------|------|--------|------|
| ì»¤ë®¤ë‹ˆí‹° | `/community` | `PublicMeditationEditor` | ê³µê°œ |
| ê°œì¸ í”„ë¡œì íŠ¸ | `/mypage/projects/[id]` | `PersonalMeditationEditor` | ê°œì¸ |
| êµíšŒ QT | `/church/[code]/qt/[date]` | `MeditationEditor` | êµíšŒ |

### 3.2 ì‘ì„± ì»´í¬ë„ŒíŠ¸ ê³„ì¸µ

```
ì—ë””í„° (ì§„ì…ì )
â”œâ”€â”€ PublicMeditationEditor     # ì»¤ë®¤ë‹ˆí‹°ìš© (Collapsible)
â”œâ”€â”€ PersonalMeditationEditor   # ê°œì¸ìš© (Dialog)
â””â”€â”€ MeditationEditor           # êµíšŒ QTìš©

    â†“ í˜•ì‹ ì„ íƒ

MeditationTypeSelector
â”œâ”€â”€ QTMeditationForm          # QT í˜•ì‹
â”œâ”€â”€ FreeMeditationForm        # ììœ  í˜•ì‹
â””â”€â”€ MemoMeditationForm        # ë©”ëª¨ í˜•ì‹
```

### 3.3 QT í˜•ì‹ í•„ë“œ

`QTMeditationForm` í•„ë“œ:

| í•„ë“œ | DB ì»¬ëŸ¼ | ì„¤ëª… | í•„ìˆ˜ |
|------|---------|------|------|
| `bibleVerse` | `bible_range` | ì„±ê²½ êµ¬ì ˆ | âœ“ |
| `oneWord` / `mySentence` | `my_sentence` | í•œ ë¬¸ì¥ ìš”ì•½ | âœ“ |
| `question` | - | ë¬µìƒ ì§ˆë¬¸ | - |
| `questionAnswer` | `meditation_answer` | ì§ˆë¬¸ ë‹µë³€ | - |
| `gratitudeApplication` | `gratitude` | ê°ì‚¬ì™€ ì ìš© | - |
| `prayer` | `my_prayer` | ë‚˜ì˜ ê¸°ë„ | - |
| `dailyCheck` | `day_review` | í•˜ë£¨ ì ê²€ | - |

---

## 4. í•µì‹¬ íŒŒì¼

### í”¼ë“œ/ë·°ì–´ ì»´í¬ë„ŒíŠ¸

| íŒŒì¼ | ì—­í•  |
|------|------|
| `src/components/feed/QTFeedCard.tsx` | QT ì „ìš© í”¼ë“œ ì¹´ë“œ (ìºëŸ¬ì…€) |
| `src/components/feed/UnifiedFeedCard.tsx` | í†µí•© í”¼ë“œ ì¹´ë“œ (QT/ë¬µìƒ ë¶„ê¸°) |
| `src/components/feed/FeedDetailModal.tsx` | í”¼ë“œ ìƒì„¸ ëª¨ë‹¬ |
| `src/components/feed/components/` | ì¹´ë“œ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë“¤ |
| `src/components/community/UnifiedFeed.tsx` | í†µí•© í”¼ë“œ ì»¨í…Œì´ë„ˆ |

### ì‘ì„±ê¸° ì»´í¬ë„ŒíŠ¸

| íŒŒì¼ | ì—­í•  |
|------|------|
| `src/components/community/PublicMeditationEditor.tsx` | ì»¤ë®¤ë‹ˆí‹° ì‘ì„± |
| `src/components/personal/PersonalMeditationEditor.tsx` | ê°œì¸ ì‘ì„± |
| `src/components/meditation/MeditationEditor.tsx` | êµíšŒ QT ì‘ì„± |
| `src/components/personal/QTMeditationForm.tsx` | QT í˜•ì‹ í¼ |
| `src/components/personal/FreeMeditationForm.tsx` | ììœ  í˜•ì‹ í¼ |
| `src/components/personal/MemoMeditationForm.tsx` | ë©”ëª¨ í˜•ì‹ í¼ |
| `src/components/personal/MeditationTypeSelector.tsx` | í˜•ì‹ ì„ íƒ UI |

### í˜ì´ì§€

| ê²½ë¡œ | íŒŒì¼ |
|------|------|
| `/qt` | `src/app/(main)/qt/page.tsx` |
| `/qt/[date]` | `src/app/(main)/qt/[date]/page.tsx` |
| `/church/[code]/qt` | `src/app/church/[code]/qt/page.tsx` |
| `/church/[code]/qt/[date]` | `src/app/church/[code]/qt/[date]/page.tsx` |

---

## 5. ì‚¬ìš©í•˜ëŠ” í›…

### QT ì¡°íšŒ

| í›… | íŒŒì¼ | ìš©ë„ |
|----|------|------|
| `useTodayQT` | `useQT.ts` | ì˜¤ëŠ˜ì˜ QT |
| `useDailyQT` | `useQT.ts` | ë‚ ì§œë³„ QT |
| `useQTByDayNumber` | `useQT.ts` | ì¼ì°¨ë³„ QT |
| `useMonthlyQT` | `useQT.ts` | ì›”ë³„ QT ëª©ë¡ |

### í”¼ë“œ/ë¬µìƒ

| í›… | íŒŒì¼ | ìš©ë„ |
|----|------|------|
| `useUnifiedFeed` | `useUnifiedFeed.ts` | í†µí•© í”¼ë“œ ì¡°íšŒ |
| `useUnifiedFeedInfinite` | `useUnifiedFeed.ts` | í†µí•© í”¼ë“œ ë¬´í•œìŠ¤í¬ë¡¤ |
| `useChurchQTPosts` | `useChurchQTPost.ts` | êµíšŒ QT ëª©ë¡ |
| `useCreateChurchQTPost` | `useChurchQTPost.ts` | êµíšŒ QT ìƒì„± |

### ëŒ“ê¸€/ì¢‹ì•„ìš”

| í›… | íŒŒì¼ | ìš©ë„ |
|----|------|------|
| `useComments` | `usePublicMeditationComment.ts` | ëŒ“ê¸€ ëª©ë¡ |
| `useCreateComment` | `usePublicMeditationComment.ts` | ëŒ“ê¸€ ì‘ì„± |
| `useIsBookmarked` | `useUserBookmarks.ts` | ë¶ë§ˆí¬ ì—¬ë¶€ |
| `useToggleBookmark` | `useUserBookmarks.ts` | ë¶ë§ˆí¬ í† ê¸€ |

---

## 6. ë°ì´í„° íë¦„

### ì¡°íšŒ íë¦„

```
ì»´í¬ë„ŒíŠ¸ (UnifiedFeed)
    â†“
useUnifiedFeedInfinite() í›…
    â†“
GetUnifiedFeed Use Case
    â†“
unified_meditations í…Œì´ë¸”
    â†“
UnifiedFeedCard
    â”œâ”€ content_type === 'qt' â†’ QTFeedCard
    â””â”€ ê·¸ ì™¸ â†’ ì¼ë°˜ ì¹´ë“œ
```

### ì‘ì„± íë¦„

```
ì—ë””í„° ì»´í¬ë„ŒíŠ¸
    â†“
í˜•ì‹ ì„ íƒ (QT/ììœ /ë©”ëª¨)
    â†“
í˜•ì‹ë³„ í¼ ì‘ì„±
    â†“
useCreateChurchQTPost() í›…
    â†“
CreateChurchQTPost Use Case
    â†“
Supabase DB (ë ˆê±°ì‹œ í…Œì´ë¸”: church_qt_posts)
    â†“ (íŠ¸ë¦¬ê±°)
unified_meditations ë™ê¸°í™”
    â†“
í”¼ë“œ ìºì‹œ ë¬´íš¨í™” â†’ í™”ë©´ ê°±ì‹ 
```

### DB í…Œì´ë¸” ê´€ê³„

```
ì €ì¥ (ë ˆê±°ì‹œ)                    ì¡°íšŒ (í†µí•©)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ church_qt_posts    â”‚ â”€â”€â”€â”€â”€â”€â†’  â”‚                      â”‚
â”‚ guest_comments     â”‚ â”€â”€â”€â”€â”€â”€â†’  â”‚ unified_meditations  â”‚
â”‚ comments           â”‚ â”€â”€â”€â”€â”€â”€â†’  â”‚                      â”‚
â”‚ public_meditations â”‚ â”€â”€â”€â”€â”€â”€â†’  â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                â†‘
        â””â”€â”€â”€â”€ íŠ¸ë¦¬ê±°ë¡œ ìë™ ë™ê¸°í™” â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ì‘ì—… ì²´í¬ë¦¬ìŠ¤íŠ¸

### QT í”¼ë“œ UI ìˆ˜ì •

- [ ] `QTFeedCard.tsx` ìˆ˜ì •
- [ ] `FeedDetailModal.tsx`ì—ì„œ QT ë Œë”ë§ í™•ì¸
- [ ] ëª¨ë°”ì¼/ë°ìŠ¤í¬í†± ë°˜ì‘í˜• í…ŒìŠ¤íŠ¸

### QT ì‘ì„± í¼ ìˆ˜ì •

- [ ] `QTMeditationForm.tsx` ìˆ˜ì •
- [ ] `PersonalMeditationEditor`ì—ì„œ í™•ì¸
- [ ] `PublicMeditationEditor`ì—ì„œ í™•ì¸

### ìƒˆ í•„ë“œ ì¶”ê°€

1. `QTMeditationForm.tsx`ì— í•„ë“œ ì¶”ê°€
2. `QTFeedCard.tsx`ì— í‘œì‹œ ë¡œì§ ì¶”ê°€
3. `FeedDetailModal.tsx`ì—ì„œ í™•ì¸
4. DB ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì‹œ ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„±

---

## 8. ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜

| ì‹¤ìˆ˜ | ì˜¬ë°”ë¥¸ ë°©ë²• |
|------|-------------|
| QTFeedCardë§Œ ìˆ˜ì •í•˜ê³  FeedDetailModal ëˆ„ë½ | ëª¨ë‹¬ì—ì„œë„ QT ë Œë”ë§ í™•ì¸ |
| í”¼ë“œ ìºì‹œ ë¬´íš¨í™” ëˆ„ë½ | `queryClient.invalidateQueries(['unified-feed'])` |
| í˜•ì‹ ë¶„ê¸° ëˆ„ë½ | `content_type === 'qt'` ì²´í¬ |

---

## 9. ì˜ì¡´ì„± ë‹¤ì´ì–´ê·¸ë¨

```
                    UnifiedFeed
                         â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â†“                     â†“
        UnifiedFeedCard      FeedDetailModal
              â”‚                     â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
    â†“                   â†“          â†“
QTFeedCard      PublicMeditationCard
    â”‚
    â”œâ”€â”€ FeedCardAvatar
    â”œâ”€â”€ FeedCardContent
    â””â”€â”€ FeedCardActions
```

---

## 10. ë³€ê²½ ì´ë ¥

| ë‚ ì§œ | ë‚´ìš© |
|------|------|
| 2026-02-01 | ì´ˆê¸° ë¬¸ì„œ ì‘ì„± (docs/QT_ARCHITECTURE.md í†µí•©) |
